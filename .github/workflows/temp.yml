# File: .github/workflows/tmate.yml
name: Tmate SSH Session

on:
  workflow_dispatch:  # manual trigger

jobs:
  tmate:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Install tmate
        run: |
          sudo apt update
          sudo apt install -y tmate

      - name: Start tmate session
        run: |
          # start tmate in the background
          tmate -S /tmp/tmate.sock new-session -d

          # wait for SSH connection string
          echo "Waiting for SSH connection..."
          sleep 5
          tmate -S /tmp/tmate.sock display -p '#{tmate_ssh}'
          tmate -S /tmp/tmate.sock display -p '#{tmate_web}'